CREATE DATABASE kart;
USE kart;
CREATE TABLE Temporada (
idTemporada INT PRIMARY KEY,
numero INT NOT NULL
);
CREATE TABLE Patrocinio (
idPatrocinio INT PRIMARY KEY AUTO_INCREMENT,
nomePatrocinio VARCHAR(45) NOT NULL
);
CREATE TABLE Equipe (
idEquipe INT PRIMARY KEY AUTO_INCREMENT,
nome VARCHAR(100) NOT NULL,
patrocinio_idPatrocinio INT,
FOREIGN KEY (patrocinio_idPatrocinio) REFERENCES Patrocinio(idPatrocinio)
);
CREATE TABLE Piloto (
idPiloto INT PRIMARY KEY AUTO_INCREMENT,
nome VARCHAR(150) NOT NULL,
peso FLOAT,
capitao TINYINT,
nacionalidade VARCHAR(45),
equipe_idEquipe INT,
FOREIGN KEY (equipe_idEquipe) REFERENCES Equipe(idEquipe)
);
CREATE TABLE Etapa (
idEtapa INT PRIMARY KEY AUTO_INCREMENT,
local VARCHAR(100),
data DATE,
hora TIME,
Temporada_idTemporada INT,
FOREIGN KEY (Temporada_idTemporada) REFERENCES Temporada(idTemporada)
);
CREATE TABLE Etapa_has_Piloto (
Etapa_idEtapa INT,
Piloto_idPiloto INT,
PRIMARY KEY (Etapa_idEtapa , Piloto_idPiloto),
FOREIGN KEY (Etapa_idEtapa)
REFERENCES Etapa (idEtapa),
FOREIGN KEY (Piloto_idPiloto)
REFERENCES Piloto (idPiloto)
);
INSERT INTO Temporada (idTemporada, numero)
VALUES (1, 1);
INSERT INTO Patrocinio (nomePatrocinio) VALUES
('MotorTech Brasil'),
('Velocidade Extrema'),
('Alta Performance'),
('Turbo Racing'),
('Pneus ProDrive');
INSERT INTO Equipe (nome, patrocinio_idPatrocinio) VALUES
('Escuderia Veloz', 1),
('Rápidos & Furiosos', 2),
('Fênix Racing', 3),
('Equipe Tempestade', 4),
('Corredores de Aço', 5);
INSERT INTO Piloto (nome, peso, capitao, nacionalidade, equipe_idEquipe) VALUES
('Lucas Andrade', 70.5, 1, 'Brasil', 1),
('Renato Figueiredo', 75.0, 0, 'Brasil', 1),
('Mateus Silva', 68.0, 0, 'Brasil', 2),
('Bruno Almeida', 78.3, 1, 'Brasil', 2),
('Carla Pereira', 60.0, 1, 'Portugal', 3),
('Gabriela Torres', 58.5, 0, 'Brasil', 3),
('João Costa', 80.5, 0, 'Brasil', 4),
('Thiago Santos', 72.5, 0, 'Brasil', 4),
('Mariana Gomes', 62.0, 1, 'Portugal', 5),
('Beatriz Lopes', 63.2, 1, 'Portugal', 5);
INSERT INTO Etapa (local, data, hora, Temporada_idTemporada) VALUES
('São Paulo', '2024-01-15', '14:00', 1),
('Rio de Janeiro', '2024-02-20', '16:00', 1),
('Campo Grande', '2024-03-18', '15:00', 1),
('Londrina', '2024-04-22', '13:00', 1),
('Porto Alegre', '2024-05-10', '10:00', 1);

SET SQL_SAFE_UPDATES = 0;
UPDATE Etapa
SET local = 'Salvador'
WHERE local = 'Campo Grande';
UPDATE Etapa
SET local = 'Goiânia'
WHERE local = 'Londrina';
DELETE FROM Patrocinio
UPDATE Equipe
SET patrocinio_idPatrocinio = NULL
WHERE patrocinio_idPatrocinio = 5;
DELETE FROM Patrocinio
WHERE nomePatrocinio = 'Pneus ProDrive';
INSERT INTO Etapa_has_Piloto VALUES
(1,1),(1,2),(1,3),(1,4),(1,5),(1,6),(1,7),(1,8),(1,9),(1,10);
SELECT 
p.nome AS Piloto,
p.peso,
p.capitao,
p.nacionalidade,
e.nome AS Equipe
FROM Piloto p
JOIN Equipe e ON p.equipe_idEquipe = e.idEquipe;
